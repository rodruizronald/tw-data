# =============================================================================
# Instructions
# =============================================================================
# 1. Copy this file: cp .env.example .env
# 2. Update "CHANGE_ME" values

# =============================================================================
# OpenAI Configuration
# =============================================================================

# Your OpenAI API key for AI-powered job analysis
OPENAI_API_KEY=CHANGE_ME  # ← Placeholder, not a real key

# =============================================================================
# Pipeline Configuration
# =============================================================================

# Path to the pipeline configuration YAML file
PIPELINE_CONFIG_FILE=pipeline.yaml

# =============================================================================
# MongoDB Database Configuration
# =============================================================================

# MongoDB connection settings
MONGO_HOST=mongo
MONGO_PORT=27017
MONGO_USERNAME=admin
MONGO_PASSWORD=CHANGE_ME  # ← Placeholder, not a real password
MONGO_DATABASE=job_scraper
MONGO_AUTH_SOURCE=admin

# MongoDB Timeout Settings (in milliseconds)
MONGO_CONNECTION_TIMEOUT=5000
MONGO_SERVER_SELECTION_TIMEOUT=5000

# MongoDB Collection Names
MONGO_JOB_LISTINGS_COLLECTION=job_listings
MONGO_JOB_METRICS_DAILY_COLLECTION=job_metrics_daily
MONGO_JOB_METRICS_AGGREGATES_COLLECTION=job_metrics_aggregates

# =============================================================================
# Prefect Workflow Configuration
# =============================================================================

# Prefect server API URL (for worker to connect to server)
PREFECT_API_URL=http://localhost:4200/api

# Prefect server host and port (for server itself)
PREFECT_SERVER_API_HOST=0.0.0.0
PREFECT_SERVER_API_PORT=4200

# Prefect UI API URL (for browser access)
PREFECT_UI_API_URL=http://localhost:4200/api

# Prefect Logging Configuration
# Include service loggers so their logs appear in Prefect UI
PREFECT_LOGGING_EXTRA_LOGGERS=services.data_service,services.openai_service,services.web_extraction_service,services.metrics_service

# =============================================================================
# Streamlit Dashboard Configuration
# =============================================================================
# Port for Streamlit dashboard (accessible at http://localhost:8501)
STREAMLIT_PORT=8501

# =============================================================================
# Supabase Configuration
# =============================================================================

# Your Supabase project URL
SUPABASE_URL=https://your-project.supabase.co

# Your Supabase service role key (for admin operations)
SUPABASE_SERVICE_KEY=CHANGE_ME  # ← Placeholder, not a real key

# Anonymous key (for user operations, if needed)
SUPABASE_ANON_KEY=CHANGE_ME  # ← Placeholder, not a real key

# Database schema (default: public)
SUPABASE_SCHEMA=public

# General request timeout (in seconds)
SUPABASE_TIMEOUT=10
SUPABASE_CONNECT_TIMEOUT=5
SUPABASE_READ_TIMEOUT=10

# ============================================
# RETRY CONFIGURATION (Tenacity)
# ============================================

# Maximum number of retry attempts (1-10)
SUPABASE_MAX_RETRIES=3

# Minimum wait between retries (seconds)
SUPABASE_RETRY_MIN_WAIT=1

# Maximum wait between retries (seconds)
SUPABASE_RETRY_MAX_WAIT=10

# Exponential backoff multiplier
SUPABASE_RETRY_MULTIPLIER=2

# ============================================
# CIRCUIT BREAKER CONFIGURATION (PyBreaker)
# ============================================

# Number of consecutive failures before circuit opens
SUPABASE_CB_FAILURE_THRESHOLD=5

# Seconds before attempting recovery (half-open state)
SUPABASE_CB_RECOVERY_TIMEOUT=60
